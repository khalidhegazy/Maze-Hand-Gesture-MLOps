from fastapi.testclient import TestClient
from main import app

def test_predict():
    landmarks = [
    129.9103775024414, 349.5534362792969,
    142.8936767578125, 344.371826171875,
    149.7077751159668, 330.20465087890625,
    146.9234848022461, 319.469970703125,
    140.02448272705078, 309.0038146972656,
    148.8277587890625, 298.0936584472656,
    150.06170654296875, 273.8567199707031,
    150.44961547851562, 258.3992919921875,
    149.8183364868164, 245.0172119140625,
    135.5313491821289, 297.2395324707031,
    137.9838409423828, 269.6021423339844,
    140.32135391235352, 251.4884033203125,
    141.85055923461914, 235.46090698242188,
    122.51679611206055, 302.55255126953125,
    124.92789459228516, 289.3178405761719,
    130.76283645629883, 306.1192321777344,
    134.22244262695312, 319.2195739746094,
    111.10997772216797, 312.5162353515625,
    118.3326416015625, 311.9268798828125,
    127.7420654296875, 324.3783874511719,
    133.72906494140625, 333.4139404296875,
    198.7678680419922, 3.3723898695825483e-07,
    124.63666534423828, 191.31466674804688,
    126.4423942565918, 180.20433044433594,
    121.04376983642578, 171.19586181640625,
    114.39111328125, 164.9900360107422,
    128.71848678588867, 164.99368286132812,
    129.61881637573242, 150.63172912597656,
    129.22943115234375, 141.399658203125,
    128.27657318115234, 133.5335235595703,
    121.72053909301758, 164.36141967773438,
    123.99882888793945, 148.39279174804688,
    124.48740005493164, 138.01943969726562,
    124.5084228515625, 129.12437438964844,
    114.75059509277344, 167.6380157470703,
    111.69583511352539, 157.8810577392578,
    113.22962951660156, 166.49929809570312,
    115.14464950561523, 173.42147827148438,
    108.0963020324707, 173.32142639160156,
    105.6976203918457, 165.9089813232422,
    107.82635879516602, 171.2321319580078,
    109.8321762084961, 176.38882446289062
  ] #two up -> up
    with TestClient(app) as client:  
        response = client.post("/predict", json={"landmarks": landmarks})
        assert response.status_code == 200, f"Error: {response.status_code} - {response.text}"
        assert response.json()["action"] in ["up", "down", "left", "right"]